# 🧪 Supabase MCP テストクエリ集

Supabase MCPが正しく動作するかテストするためのクエリ例集です。

## 🔍 基本的な確認クエリ

### データベース接続テスト
```
Claude Codeに以下のように質問してください：

「Supabaseに接続できていますか？」
「データベースの状態を教えてください」
```

### テーブル構造の確認
```
「news_articlesテーブルの構造を表示してください」
「テーブル一覧を教えてください」
「news_articlesテーブルのカラム情報を詳しく表示してください」
```

## 📊 データ確認クエリ

### 基本的なデータ取得
```
「news_articlesテーブルの全件数を教えてください」
「最新の記事を5件表示してください」
「記事のタイトル一覧を表示してください」
```

### カテゴリ別分析
```
「カテゴリ別の記事数を表示してください」
「AIカテゴリの記事を全て表示してください」
「各カテゴリで最も重要度の高い記事を1件ずつ表示してください」
```

### 重要度分析
```
「importance_scoreが8.0以上の記事を表示してください」
「重要度スコアの分布を教えてください」
「最も重要度の高い記事トップ10を表示してください」
```

## 🚀 高度なクエリ

### 条件付き検索
```
「OpenAIに関する記事を検索してください」
「昨日以降に投稿された記事を表示してください」
「英語の記事で重要度7.0以上のものを表示してください」
```

### 集計・統計
```
「ソース別の記事数を表示してください」
「言語別の記事数を表示してください」
「過去24時間の記事投稿数を教えてください」
```

### 複合条件
```
「TechカテゴリかつJapan発信の記事を表示してください」
「重要度5.0以上で、タイトルにAIが含まれる記事を検索してください」
「翻訳済みの記事で、カテゴリがStartupのものを表示してください」
```

## 🛠️ スキーマ管理クエリ

### インデックス確認
```
「news_articlesテーブルのインデックス一覧を表示してください」
「パフォーマンスに関するインデックスの状況を教えてください」
```

### 制約確認
```
「news_articlesテーブルの制約を全て表示してください」
「importance_scoreカラムの制約を確認してください」
「categoryカラムで許可されている値を教えてください」
```

### テーブル関係
```
「外部キー制約を表示してください」
「テーブル間の関係を教えてください」
```

## 📈 Phase 4.5準備確認

### 拡張カラムの確認
```
「enhanced_summaryカラムが存在するか確認してください」
「quality_levelカラムの設定を表示してください」
「Phase 4.5用の拡張カラムが全て準備できているか確認してください」
```

### データ型確認
```
「importance_scoreカラムのデータ型を確認してください」
「processing_costカラムの設定を表示してください」
```

## 🎯 実用的なクエリ例

### RSS収集システム用
```
「重複チェック用のクエリを実行してください」
「最新の収集日時を表示してください」
「source_urlでの重複記事があるか確認してください」
```

### ユーザー向け表示用
```
「フロントエンド表示用の記事一覧を取得してください」
「カテゴリタブ用のカテゴリ別件数を表示してください」
「人気記事ランキングを表示してください」
```

### 管理者向け分析
```
「データベースの健全性をチェックしてください」
「異常な重要度スコアがないか確認してください」
「欠損データがないか確認してください」
```

## 🔧 トラブルシューティング用

### 接続問題の診断
```
「MCP接続状態を確認してください」
「権限エラーが出ていないか確認してください」
「read-onlyモードで動作しているか確認してください」
```

### データ整合性チェック
```
「NOT NULL制約違反がないか確認してください」
「CHECK制約違反がないか確認してください」
「UNIQUE制約違反がないか確認してください」
```

## 📝 期待される結果例

### 正常な応答例
```
テーブル構造確認 → カラム一覧とデータ型の表示
記事件数確認 → 数値での件数回答
カテゴリ別集計 → カテゴリごとの件数テーブル
重要度分析 → スコア別の記事一覧
```

### エラー時の対応
```
接続エラー → アクセストークンの確認
権限エラー → read-onlyモードの確認
データエラー → データベース制約の確認
```

## 🎉 成功確認チェックリスト

- [ ] データベース接続成功
- [ ] テーブル構造表示成功
- [ ] 基本的なSELECTクエリ実行成功
- [ ] 集計クエリ実行成功
- [ ] 条件付き検索成功
- [ ] エラーハンドリング確認

## 💡 活用アイデア

### 開発時
- データベース設計の確認
- サンプルデータの生成
- パフォーマンステスト

### 運用時
- データの健全性チェック
- 記事品質の分析
- ユーザー行動の分析

### デバッグ時
- データ不整合の発見
- パフォーマンス問題の特定
- エラーの原因調査

---

**使用方法**: 上記のクエリをClaude Codeで自然言語として質問してください。MCPが自動的にSQLに変換して実行します。

**注意**: read-onlyモードでは更新・削除クエリは実行できません。